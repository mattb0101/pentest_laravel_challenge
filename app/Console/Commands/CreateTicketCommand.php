<?php

namespace App\Console\Commands;

use App\Models\Ticket;
use Illuminate\Support\Facades\DB;
use Exception;
use Illuminate\Console\Command;

class CreateTicketCommand extends Command
{
    /**
     * Path to execute the create ticket console command.
     *
     * @var string
     */
    protected $signature = 'app:create-ticket';

    /**
     * The commands description.
     *
     * @var string
     */
    protected $description = 'Creates a New Ticket';

    /**
     * Execute the console command.
     */
    public function handle()
    {
        try {
            $users = DB::table('users')->paginate(5);

            if (empty($users->items())) {
                throw new Exception('The DB has no users to assign to a ticket, please create some first.');
            }

            Ticket::factory()->create();

            $this->info('Ticket created!');
        } catch (Exception $err) {
            return $this->info($err->getMessage());
        }

        
    }
}
